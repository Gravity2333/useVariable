import*as e from"react";import*as t from"react-dom";var r={d:(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},n={};r.d(n,{f:()=>c,A:()=>b});const o=(s={useMemo:()=>e.useMemo,useRef:()=>e.useRef,useState:()=>e.useState},a={},r.d(a,s),a),c="/";var s,a;const u=(e=>{var t={};return r.d(t,e),t})({flushSync:()=>t.flushSync});function f(e,t,r,n){for(const o in e){const c=e[o];"object"==typeof c&&null!==c&&(e[o]=f(c,t,r,n))}return new Proxy(e,{get(e,t,n){const o=Reflect.get(e,t,n);return r&&r(e,t,n),o},set(e,r,n,o){const c=Reflect.set(e,r,n,o);return t&&t(e,r,n,o),c},deleteProperty(e,t){const r=Reflect.deleteProperty(e,t);return n&&n(e,t),r}})}function l({config:e=[]}){const[t]=function(){const[e,t]=(0,o.useState)(0);return[()=>{(0,u.flushSync)((()=>{t(e>99999?0:e=>e+1)}))}]}(),r=(0,o.useRef)(f(e.reduce(((e,t)=>({...e,[t.name]:void 0!==t.initialValue?t.initialValue:{}})),{}),t,(()=>{}),t)),[n,s]=(0,o.useState)({});function a(e,t=!1){void 0!==n[e]&&s((r=>({...r,[e]:t})))}const l=(0,o.useMemo)((()=>{const t={},r=e.reduce(((e,r)=>(0!==Object.keys(r.effects||{})?.length&&Object.keys(r.effects||{}).forEach((e=>{t[`${r.name}${c}${e}`]=!1})),{...e,[r.name]:r})),{})||{};return s(t),r}),[]),i=({type:e,payload:t},n)=>new Promise(((o,s)=>{const[u,f]=e.split(c),d=l[u],{reducers:y={},effects:b={}}=d||{};b[f]?o(((e,t,n,o,c)=>new Promise((s=>{const u=r.current[t];var f;s((f=(t,r,s)=>{e({call:t,setLoading:a.bind(null,n),Control:{return:r,error:s}},{store:u,dispatch:c||i},o)},new Promise(((e,t)=>{const r=[];let n=0;const o=(e,t)=>{const o=r[n];if(!o){const o={};throw r[n++]=o,e(t).then((e=>{o.status="fulfilled",o.value=e}),(e=>{o.status="rejected",o.error=e}))}if(n++,"fulfilled"===o.status)return o.value;if("rejected"===o.status)throw new Error(o.error)},c=()=>{try{f(o,e,t)}catch(e){if(!(e instanceof Promise))throw new Error(e);return e.then((()=>{n=0,c()})),{}}};c()}))))})))(b[f],u,e,t,n)):y[f]&&o(((e,t,n)=>new Promise((o=>{const c=r.current[t];o(e(c,{payload:n}))})))(y[f],u,t)),s("未找到对应的effect/reducer")}));return[r.current,i,function(e){return n[e]}]}const i="VARIABLES";function d(e){return`${i}${c}${e}`}function y(e){const t={name:i,initialValue:{},reducers:{},effects:{}},{variables:r={},reducers:n={},effects:o={}}=e;return Object.keys(r).forEach((e=>{const n=r[e];Object.defineProperty(t.initialValue,e,{value:n,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(t.reducers,function(e){return`set${t=e,t.charAt(0).toUpperCase()+t.slice(1)}`;var t}(e),{configurable:!0,enumerable:!0,writable:!0,value:(t,r)=>{t[e]=r.payload}})})),Object.keys(n).forEach((e=>{Object.defineProperty(t.reducers,e,{configurable:!0,enumerable:!0,writable:!0,value:n[e]})})),Object.keys(o).forEach((e=>{Object.defineProperty(t.effects,e,{configurable:!0,enumerable:!0,writable:!0,value:o[e]})})),t}function b(e){const[t,r,n]=l({config:[y(e)]}),o=e=>r({type:d(e.type),payload:e.payload},o);return[t[i],o,e=>n(d(e))]}var p=n.f,m=n.A;export{p as USE_STORE_TYPE_SPLITER,m as default};